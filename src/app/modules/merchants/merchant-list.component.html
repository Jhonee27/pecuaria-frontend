<div class="container mt-5">
  <div class="card shadow-sm p-4">

    <h2>Lista de Comerciantes</h2>
    <p class="text-muted">Gestión de comerciantes del sistema</p>

    <!-- Mensajes de información -->
    <div *ngIf="message" class="alert alert-info text-center">{{ message }}</div>

    <!-- Botón Agregar / Cancelar -->
    <div class="text-end mb-3">
      <button class="btn btn-success btn-lg" (click)="toggleForm()">
        {{ showForm ? 'Cancelar' : 'Agregar Comerciante' }}
      </button>
    </div>

    <!-- Formulario de agregado -->
    <div *ngIf="showForm" class="mb-4">
      <form (ngSubmit)="saveMerchant()" #merchantForm="ngForm" class="form-add-merchant">
        <div class="form-group mb-2">
          <input type="text" placeholder="Nombre" [(ngModel)]="newMerchant.firstName" name="firstName" class="form-control" required />
        </div>
        <div class="form-group mb-2">
          <input type="text" placeholder="Apellido" [(ngModel)]="newMerchant.lastName" name="lastName" class="form-control" required />
        </div>
        <div class="form-group mb-2">
          <input type="text" placeholder="DNI" [(ngModel)]="newMerchant.dni" name="dni" class="form-control" required />
        </div>
        <div class="form-group mb-2">
          <input type="text" placeholder="Teléfono" [(ngModel)]="newMerchant.phone" name="phone" class="form-control" />
        </div>
        <button class="btn btn-primary w-100 mt-2" type="submit" [disabled]="merchantForm.invalid">
          {{ editingMerchantId ? 'Actualizar' : 'Guardar' }}
        </button>
      </form>
    </div>

    <hr />

    <!-- Lista de comerciantes como tarjetas -->
    <div class="merchant-cards">
      <div *ngFor="let m of merchants" class="merchant-card shadow-sm">
        <div class="merchant-info">
          <div class="user-icon">
            <i class="bi bi-person-circle"></i>
          </div>
          <div class="text-info">
            <strong>{{ m.firstName }} {{ m.lastName }}</strong>
            <p>DNI: {{ m.dni }}</p>
            <p>
              <span [ngClass]="m.phone ? 'phone-active' : 'phone-inactive'">
                <i class="bi bi-telephone-fill"></i> {{ m.phone || 'Sin teléfono' }}
              </span>
            </p>
          </div>
        </div>
        <div class="merchant-actions">
          <button class="btn btn-warning btn-sm" (click)="editMerchant(m)">Editar</button>
          <button class="btn btn-danger btn-sm" (click)="deleteMerchant(m.id)">Eliminar</button>
        </div>
      </div>
    </div>

    <div *ngIf="merchants.length === 0 && !loading" class="text-center text-muted mt-3">
      No hay comerciantes registrados.
    </div>
  </div>
</div>

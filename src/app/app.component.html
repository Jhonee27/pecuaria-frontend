<div class="app-container">
  <!-- ✅ Navbar (solo si está autenticado) -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow-sm" *ngIf="isAuthenticated()">
    <div class="container-fluid px-4">
      <!-- Brand -->
      <a class="navbar-brand fw-bold d-flex align-items-center" routerLink="/dashboard">
        <i class="bi bi-building me-2 fs-4"></i>
        {{ appName }}
      </a>

      <!-- Toggler para móviles -->
      <button 
        class="navbar-toggler" 
        type="button" 
        data-bs-toggle="collapse" 
        data-bs-target="#navbarNav"
        aria-controls="navbarNav" 
        aria-expanded="false" 
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Menú de navegación -->
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0">
          <!-- Dashboard -->
          <li class="nav-item">
            <a class="nav-link" routerLink="/dashboard" routerLinkActive="active">
              <i class="bi bi-speedometer2 me-2"></i> Dashboard
            </a>
          </li>

          <!-- Comerciantes -->
          <li class="nav-item">
            <a class="nav-link" routerLink="/merchants" routerLinkActive="active">
              <i class="bi bi-people me-2"></i> Comerciantes
            </a>
          </li>

          <!-- Movimientos -->
          <li class="nav-item">
            <a class="nav-link" routerLink="/movements" routerLinkActive="active">
              <i class="bi bi-truck me-2"></i> Movimientos
            </a>
          </li>

          <!-- Estadísticas (solo Admin) -->
          <li class="nav-item" *ngIf="currentUser?.role === 'admin'">
            <a class="nav-link" routerLink="/statistics" routerLinkActive="active">
              <i class="bi bi-bar-chart-line me-2"></i> Estadísticas
            </a>
          </li>

          <!-- Gestión de Usuarios (solo Admin) -->
          <li class="nav-item" *ngIf="currentUser?.role === 'admin'">
            <a class="nav-link" routerLink="/admin/users" routerLinkActive="active">
              <i class="bi bi-person-gear me-2"></i> Gestión de Usuarios
            </a>
          </li>
        </ul>

        <!-- Usuario actual -->
        <ul class="navbar-nav">
          <li class="nav-item dropdown">
            <a 
              class="nav-link dropdown-toggle d-flex align-items-center" 
              href="#" 
              role="button" 
              data-bs-toggle="dropdown"
            >
              <i class="bi bi-person-circle fs-5 me-2"></i>
              <div class="d-flex flex-column text-start">
                <span class="fw-semibold">{{ currentUser?.email }}</span>
                <small class="badge bg-light text-dark">
                  {{ currentUser?.role === 'admin' ? 'Administrador' : 'Personal' }}
                </small>
              </div>
            </a>

            <!-- Menú desplegable -->
            <ul class="dropdown-menu dropdown-menu-end shadow-sm">
              <li>
                <a class="dropdown-item" routerLink="/profile">
                  <i class="bi bi-person me-2 text-primary"></i> Mi Perfil
                </a>
              </li>
              <li>
                <a class="dropdown-item" routerLink="/settings">
                  <i class="bi bi-gear me-2 text-secondary"></i> Configuración
                </a>
              </li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <a 
                  class="dropdown-item text-danger fw-semibold" 
                  (click)="logout()" 
                  style="cursor: pointer;"
                >
                  <i class="bi bi-box-arrow-right me-2"></i> Cerrar Sesión
                </a>
              </li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- ✅ Contenido principal -->
  <main class="main-content" [class.authenticated]="isAuthenticated()">
    <router-outlet></router-outlet>
  </main>
</div>
